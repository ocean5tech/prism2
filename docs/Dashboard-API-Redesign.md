# Dashboard API é‡æ–°è®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ é—®é¢˜åˆ†æ

å½“å‰Dashboard APIå­˜åœ¨çš„é—®é¢˜ï¼š
1. **æ•°æ®è¿‡äºç®€å•**ï¼šåªæœ‰åŸºæœ¬ä¿¡æ¯ã€å®æ—¶ä»·æ ¼å’Œ1å¤©Kçº¿
2. **æ•°æ®æºå•ä¸€**ï¼šä¸»è¦ä¾èµ–AKShareï¼Œç¼ºä¹å¤šæºæ•°æ®æ•´åˆ
3. **ç¼ºä¹æ·±åº¦åˆ†æ**ï¼šæ²¡æœ‰AIåˆ†æã€è´¢åŠ¡åˆ†æã€æ–°é—»èˆ†æƒ…ç­‰
4. **Kçº¿æ•°æ®ä¸è¶³**ï¼š1å¤©æ•°æ®æ— æ³•ç»˜åˆ¶æœ‰æ„ä¹‰çš„å›¾è¡¨
5. **ç¼ºå°‘å…³é”®ä¿¡æ¯**ï¼šæ²¡æœ‰å…¬å‘Šã€æ–°é—»ã€é¾™è™æ¦œã€è‚¡ä¸œä¿¡æ¯ç­‰

## ğŸ¯ é‡æ–°è®¾è®¡çš„Dashboard API

### ğŸ“Š ç»¼åˆæ•°æ®æ¶æ„

```
Dashboard API = PostgreSQLé™æ€æ•°æ® + AKShareå®æ—¶æ•°æ® + RAG AIåˆ†æ + æ–°é—»å…¬å‘Šæ•°æ®
```

### ğŸ—‚ï¸ æ•°æ®åˆ†ç±»ä¸æ¥æº

#### 1. **PostgreSQLå­˜å‚¨çš„é™æ€æ•°æ®**
- ğŸ“ˆ **åŸºæœ¬ä¿¡æ¯**ï¼šå…¬å¸åç§°ã€è¡Œä¸šã€å¸‚å€¼ã€è‚¡æœ¬ç»“æ„
- ğŸ’° **è´¢åŠ¡æ•°æ®**ï¼šæœ€è¿‘8ä¸ªå­£åº¦è´¢æŠ¥æ•°æ®
- ğŸ‘¥ **è‚¡ä¸œä¿¡æ¯**ï¼šå‰åå¤§è‚¡ä¸œã€è‚¡ä¸œå˜åŒ–
- ğŸ† **é¾™è™æ¦œ**ï¼šå†å²é¾™è™æ¦œæ•°æ®
- ğŸ¢ **å…¬å¸æ²»ç†**ï¼šç®¡ç†å±‚ä¿¡æ¯ã€å…¬å¸ç®€ä»‹

#### 2. **AKShareå®æ—¶æ•°æ®**
- ğŸ“Š **å®æ—¶è¡Œæƒ…**ï¼šä»·æ ¼ã€æ¶¨è·Œã€æˆäº¤é‡
- ğŸ“ˆ **Kçº¿æ•°æ®**ï¼šæ—¥Kã€å‘¨Kã€æœˆK (60å¤©-2å¹´æ•°æ®)
- ğŸ“° **æœ€æ–°å…¬å‘Š**ï¼šå½“æ—¥æ–°å‘å¸ƒå…¬å‘Š
- ğŸ“¢ **æ–°é—»èµ„è®¯**ï¼šç›¸å…³æ–°é—»å’Œç ”æŠ¥
- ğŸ’¹ **æŠ€æœ¯æŒ‡æ ‡**ï¼šMAã€MACDã€RSIç­‰

#### 3. **RAG + AIåˆ†ææ•°æ®**
- ğŸ¤– **AIè‚¡ç¥¨è¯„ä»·**ï¼šåŸºäºè´¢æŠ¥å’Œæ–°é—»çš„æ™ºèƒ½åˆ†æ
- ğŸ“Š **æŠ•èµ„å»ºè®®**ï¼šä¹°å…¥/å–å‡º/æŒæœ‰å»ºè®®
- ğŸ“ˆ **è¶‹åŠ¿åˆ†æ**ï¼šæŠ€æœ¯é¢å’ŒåŸºæœ¬é¢ç»¼åˆåˆ¤æ–­
- âš ï¸ **é£é™©æç¤º**ï¼šæ½œåœ¨é£é™©è¯†åˆ«

### ğŸ”§ APIè®¾è®¡æ–¹æ¡ˆ

#### Request Structure
```json
{
  "stock_code": "601169",
  "data_types": [
    "basic_info",      // åŸºæœ¬ä¿¡æ¯ (PostgreSQL)
    "realtime",        // å®æ—¶è¡Œæƒ… (AKShare)
    "kline",          // Kçº¿æ•°æ® (AKShare)
    "financial",       // è´¢åŠ¡æ•°æ® (PostgreSQL)
    "shareholders",    // è‚¡ä¸œä¿¡æ¯ (PostgreSQL)
    "longhubang",     // é¾™è™æ¦œ (PostgreSQL)
    "announcements",   // å…¬å‘Šä¿¡æ¯ (AKShare)
    "news",           // æ–°é—»èµ„è®¯ (AKShare)
    "ai_analysis"     // AIåˆ†æ (RAG Service)
  ],
  "kline_period": "daily",    // å¯é€‰ï¼šdaily/weekly/monthly
  "kline_days": 60,          // å¯é€‰ï¼šKçº¿å¤©æ•°
  "news_days": 7             // å¯é€‰ï¼šæ–°é—»å¤©æ•°
}
```

#### Response Structure
```json
{
  "success": true,
  "stock_code": "601169",
  "stock_name": "åŒ—äº¬é“¶è¡Œ",
  "timestamp": "2025-09-19T11:00:00Z",
  "data_sources": {
    "postgresql": ["basic_info", "financial", "shareholders", "longhubang"],
    "akshare": ["realtime", "kline", "announcements", "news"],
    "rag_service": ["ai_analysis"]
  },
  "data": {
    "basic_info": {
      "code": "601169",
      "name": "åŒ—äº¬é“¶è¡Œ",
      "market": "SH",
      "industry": "é“¶è¡Œ",
      "sector": "é‡‘èä¸š",
      "market_cap": 120000000000,
      "total_shares": 20000000000,
      "float_shares": 18000000000,
      "pe_ratio": 4.5,
      "pb_ratio": 0.6,
      "dividend_yield": 3.2,
      "listing_date": "2007-09-19"
    },
    "realtime": {
      "current_price": 5.62,
      "change_amount": -0.01,
      "change_percent": -0.18,
      "volume": 1169646,
      "turnover": 655088331.0,
      "high": 5.73,
      "low": 5.55,
      "open": 5.63,
      "prev_close": 5.63,
      "amplitude": 3.2,
      "volume_ratio": 0.85,
      "turnover_rate": 0.65,
      "timestamp": "2025-09-19T11:00:00Z"
    },
    "kline": {
      "period": "daily",
      "days": 60,
      "data": [
        {
          "date": "2025-09-18",
          "open": 5.60,
          "high": 5.75,
          "low": 5.55,
          "close": 5.63,
          "volume": 1200000,
          "turnover": 6750000,
          "change_percent": 0.54
        }
        // ... 59 more days
      ]
    },
    "financial": {
      "latest_quarter": "2024Q3",
      "revenue_ttm": 45600000000,      // æ»šåŠ¨12ä¸ªæœˆè¥æ”¶
      "net_profit_ttm": 23400000000,   // æ»šåŠ¨12ä¸ªæœˆå‡€åˆ©æ¶¦
      "roe": 12.5,                     // å‡€èµ„äº§æ”¶ç›Šç‡
      "roa": 0.85,                     // æ€»èµ„äº§æ”¶ç›Šç‡
      "debt_ratio": 0.92,              // èµ„äº§è´Ÿå€ºç‡
      "quarterly_data": [
        {
          "quarter": "2024Q3",
          "revenue": 11800000000,
          "net_profit": 6200000000,
          "eps": 0.31,
          "revenue_growth": 8.5,
          "profit_growth": 12.3
        },
        {
          "quarter": "2024Q2",
          "revenue": 11200000000,
          "net_profit": 5800000000,
          "eps": 0.29,
          "revenue_growth": 7.2,
          "profit_growth": 10.1
        }
        // ... æœ€è¿‘8ä¸ªå­£åº¦
      ]
    },
    "shareholders": {
      "update_date": "2024-09-30",
      "total_shareholders": 145623,
      "top_10": [
        {
          "rank": 1,
          "name": "åŒ—äº¬å¸‚å›½æœ‰èµ„äº§ç»è¥æœ‰é™è´£ä»»å…¬å¸",
          "shares": 2850000000,
          "ratio": 14.25,
          "type": "å›½æœ‰è‚¡"
        },
        {
          "rank": 2,
          "name": "INGé“¶è¡Œ",
          "shares": 2680000000,
          "ratio": 13.40,
          "type": "å¤–èµ„è‚¡"
        }
        // ... å‰10å¤§è‚¡ä¸œ
      ],
      "changes": [
        {
          "date": "2024-09-30",
          "shareholder": "INGé“¶è¡Œ",
          "change_type": "å¢æŒ",
          "change_shares": 50000000,
          "change_ratio": 0.25
        }
      ]
    },
    "longhubang": {
      "recent_records": [
        {
          "date": "2025-09-18",
          "reason": "æ—¥è·Œå¹…åç¦»å€¼è¾¾7%",
          "buy_amount": 125600000,
          "sell_amount": 98500000,
          "net_amount": 27100000,
          "details": [
            {
              "seat_name": "ä¸­ä¿¡è¯åˆ¸ä¸Šæµ·åˆ†å…¬å¸",
              "buy_amount": 45600000,
              "sell_amount": 0,
              "net_amount": 45600000
            }
          ]
        }
      ]
    },
    "announcements": {
      "recent_days": 7,
      "count": 3,
      "list": [
        {
          "date": "2025-09-18",
          "title": "åŒ—äº¬é“¶è¡Œè‚¡ä»½æœ‰é™å…¬å¸ç¬¬ä¸‰å­£åº¦æŠ¥å‘Š",
          "type": "å®šæœŸæŠ¥å‘Š",
          "url": "http://static.cninfo.com.cn/...",
          "summary": "å…¬å¸2024å¹´ç¬¬ä¸‰å­£åº¦å®ç°è¥ä¸šæ”¶å…¥118äº¿å…ƒï¼ŒåŒæ¯”å¢é•¿8.5%..."
        },
        {
          "date": "2025-09-15",
          "title": "å…³äºè‘£äº‹ä¼šæ¢å±Šé€‰ä¸¾çš„å…¬å‘Š",
          "type": "ä¸´æ—¶å…¬å‘Š",
          "url": "http://static.cninfo.com.cn/...",
          "summary": "å…¬å¸è‘£äº‹ä¼šè¿›è¡Œæ¢å±Šé€‰ä¸¾ï¼Œé€‰ä¸¾æ–°ä¸€å±Šè‘£äº‹ä¼šæˆå‘˜..."
        }
      ]
    },
    "news": {
      "recent_days": 7,
      "count": 8,
      "list": [
        {
          "date": "2025-09-19",
          "title": "åŒ—äº¬é“¶è¡Œä¸‰å­£æŠ¥ï¼šå‡€åˆ©æ¶¦åŒæ¯”å¢é•¿12.3%ï¼Œèµ„äº§è´¨é‡æŒç»­æ”¹å–„",
          "source": "è´¢ç»ç½‘",
          "sentiment": "positive",
          "url": "https://...",
          "summary": "åŒ—äº¬é“¶è¡Œå‘å¸ƒä¸‰å­£æŠ¥ï¼Œä¸šç»©è¡¨ç°äº®çœ¼..."
        },
        {
          "date": "2025-09-18",
          "title": "é“¶è¡Œä¸šæ•°å­—åŒ–è½¬å‹åŠ é€Ÿï¼ŒåŒ—äº¬é“¶è¡Œç§‘æŠ€æŠ•å…¥å¢é•¿25%",
          "source": "è¯åˆ¸æ—¶æŠ¥",
          "sentiment": "positive",
          "url": "https://...",
          "summary": "éšç€é“¶è¡Œä¸šæ•°å­—åŒ–è½¬å‹çš„æ·±å…¥..."
        }
      ]
    },
    "ai_analysis": {
      "overall_rating": "ä¹°å…¥",
      "confidence": 0.78,
      "price_target": 6.20,
      "analysis": {
        "fundamental": {
          "score": 8.5,
          "summary": "åŸºæœ¬é¢ç¨³å¥ï¼Œç›ˆåˆ©èƒ½åŠ›å¼ºã€‚ROEä¿æŒåœ¨12%ä»¥ä¸Šï¼Œèµ„äº§è´¨é‡æŒç»­æ”¹å–„ï¼Œä¸è‰¯è´·æ¬¾ç‡æ§åˆ¶è‰¯å¥½ã€‚"
        },
        "technical": {
          "score": 7.2,
          "summary": "æŠ€æœ¯é¢åå¼ºã€‚è‚¡ä»·çªç ´60æ—¥å‡çº¿ï¼ŒMACDæŒ‡æ ‡æ˜¾ç¤ºå¤šå¤´æ’åˆ—ï¼Œæˆäº¤é‡æ¸©å’Œæ”¾å¤§ã€‚"
        },
        "valuation": {
          "score": 8.8,
          "summary": "ä¼°å€¼å…·å¤‡å¸å¼•åŠ›ã€‚å½“å‰PBä»…0.6å€ï¼Œä½äºé“¶è¡Œä¸šå¹³å‡æ°´å¹³ï¼Œè‚¡æ¯ç‡3.2%ï¼Œå…·å¤‡ä»·å€¼æŠ•èµ„å±æ€§ã€‚"
        },
        "risk_factors": [
          "å®è§‚ç»æµä¸‹è¡Œå‹åŠ›å¯èƒ½å½±å“é“¶è¡Œèµ„äº§è´¨é‡",
          "åˆ©ç‡å¸‚åœºåŒ–å¯¹å‡€æ¯å·®å½¢æˆå‹åŠ›",
          "æˆ¿åœ°äº§è¡Œä¸šé£é™©éœ€æŒç»­å…³æ³¨"
        ],
        "catalysts": [
          "æ•°å­—åŒ–è½¬å‹æ•ˆæœé€æ­¥æ˜¾ç°",
          "äº¬æ´¥å†€ä¸€ä½“åŒ–æ”¿ç­–æ”¯æŒ",
          "èµ„æœ¬å……è¶³ç‡æå‡æ”¯æŒä¸šåŠ¡æ‰©å¼ "
        ]
      },
      "generated_at": "2025-09-19T11:00:00Z",
      "model_version": "qwen2.5-7b-instruct"
    }
  }
}
```

## ğŸš€ å®æ–½è®¡åˆ’

### Phase 1: æ‰©å±•AKShareæ•°æ®è·å–
1. **Kçº¿æ•°æ®å¢å¼º**ï¼šè·å–60å¤©æ—¥Kçº¿æ•°æ®
2. **å…¬å‘Šæ–°é—»æ¥å£**ï¼šé›†æˆå…¬å‘Šå’Œæ–°é—»æ•°æ®
3. **è´¢åŠ¡æ•°æ®æ¥å£**ï¼šè·å–å­£æŠ¥æ•°æ®

### Phase 2: PostgreSQLæ•°æ®ç»“æ„
1. **è®¾è®¡è¡¨ç»“æ„**ï¼šè‚¡ä¸œã€é¾™è™æ¦œã€è´¢åŠ¡æ•°æ®è¡¨
2. **æ•°æ®å¯¼å…¥**ï¼šæ‰¹é‡å¯¼å…¥å†å²æ•°æ®
3. **å®šæœŸæ›´æ–°**ï¼šå»ºç«‹æ•°æ®æ›´æ–°æœºåˆ¶

### Phase 3: RAGæœåŠ¡é›†æˆ
1. **AIåˆ†ææ¥å£**ï¼šè¿æ¥RAGæœåŠ¡
2. **æ™ºèƒ½è¯„ä»·**ï¼šåŸºäºå¤šç»´æ•°æ®çš„AIåˆ†æ
3. **é£é™©è¯†åˆ«**ï¼šæ™ºèƒ½é£é™©æç¤º

### Phase 4: æ€§èƒ½ä¼˜åŒ–
1. **ç¼“å­˜ç­–ç•¥**ï¼šä¸åŒæ•°æ®ç±»å‹çš„ç¼“å­˜TTL
2. **å¹¶å‘å¤„ç†**ï¼šå¤šæ•°æ®æºå¹¶è¡Œè·å–
3. **é™çº§æœºåˆ¶**ï¼šæ•°æ®æºæ•…éšœæ—¶çš„å¤„ç†

## ğŸ“Š æ•°æ®è·å–ç­–ç•¥

### ğŸ”¥ é«˜é¢‘å®æ—¶æ•°æ® (æ¯æ¬¡è°ƒç”¨)
- å®æ—¶è¡Œæƒ…
- æœ€æ–°å…¬å‘Š (å½“æ—¥)
- AIåˆ†æ (åŸºäºæœ€æ–°æ•°æ®)

### ğŸ”„ ä¸­é¢‘æ›´æ–°æ•°æ® (ç¼“å­˜30åˆ†é’Ÿ)
- Kçº¿æ•°æ®
- æ–°é—»èµ„è®¯
- æŠ€æœ¯æŒ‡æ ‡

### ğŸ“š ä½é¢‘é™æ€æ•°æ® (ç¼“å­˜1å¤©)
- åŸºæœ¬ä¿¡æ¯
- è´¢åŠ¡æ•°æ®
- è‚¡ä¸œä¿¡æ¯
- é¾™è™æ¦œå†å²

---

è¿™æ ·è®¾è®¡çš„Dashboard APIå°†æä¾›ï¼š
- **å®Œæ•´çš„æŠ•èµ„å†³ç­–ä¿¡æ¯**
- **å¤šç»´åº¦çš„æ•°æ®åˆ†æ**
- **å®ç”¨çš„Kçº¿å›¾è¡¨æ•°æ®**
- **æ™ºèƒ½çš„AIæŠ•èµ„å»ºè®®**
- **åŠæ—¶çš„æ–°é—»å…¬å‘Šä¿¡æ¯**

æ˜¯å¦å¼€å§‹å®æ–½è¿™ä¸ªç»¼åˆæ€§çš„Dashboard APIè®¾è®¡ï¼Ÿ